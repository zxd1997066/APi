<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="1" skipped="0" tests="60" time="1817.666" timestamp="2025-09-11T12:43:02.233891+00:00" hostname="dut7358"><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_compatible_with_trec" time="31.951" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_flatten_sharded_optim_state_dict_nested" time="31.649" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_flatten_sharded_optim_state_dict_transformer" time="32.157" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_full_optim_state_dict_keys" time="31.457" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_full_optim_state_dict_nested_invalid" time="31.648" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_interface_arguments" time="31.857" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_no_grad" time="31.556" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_input_warning" time="31.255" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_False_rank0_only_False_use_diff_optim_inputs_False" time="31.858" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_False_rank0_only_False_use_diff_optim_inputs_True" time="31.657" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_False_rank0_only_True_use_diff_optim_inputs_False" time="31.758" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_False_rank0_only_True_use_diff_optim_inputs_True" time="31.657" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_True_rank0_only_False_use_diff_optim_inputs_False" time="31.657" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_True_rank0_only_False_use_diff_optim_inputs_True" time="31.457" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_True_rank0_only_True_use_diff_optim_inputs_False" time="31.759" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type0_use_multiple_param_groups_True_rank0_only_True_use_diff_optim_inputs_True" time="31.656" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_False_rank0_only_False_use_diff_optim_inputs_False" time="31.553" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_False_rank0_only_False_use_diff_optim_inputs_True" time="31.757" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_False_rank0_only_True_use_diff_optim_inputs_False" time="15.730" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_False_rank0_only_True_use_diff_optim_inputs_True" time="15.730" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_True_rank0_only_False_use_diff_optim_inputs_False" time="31.356" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_True_rank0_only_False_use_diff_optim_inputs_True" time="31.657" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_True_rank0_only_True_use_diff_optim_inputs_False" time="15.730" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_dict_nested_state_dict_type1_use_multiple_param_groups_True_rank0_only_True_use_diff_optim_inputs_True" time="15.729" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_optim_state_without_param_groups" time="31.658" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_rekey_optim_state_dict_to_ids_state_dict_type0_use_multiple_param_groups_False" time="31.657" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_rekey_optim_state_dict_to_ids_state_dict_type0_use_multiple_param_groups_True" time="31.557" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_rekey_optim_state_dict_to_ids_state_dict_type1_use_multiple_param_groups_False" time="31.457" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_rekey_optim_state_dict_to_ids_state_dict_type1_use_multiple_param_groups_True" time="31.658" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_rekey_optim_state_dict_to_names" time="31.958" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_save_load_without_0th_param_state_state_dict_type0" time="31.458" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_save_load_without_0th_param_state_state_dict_type1" time="31.056" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_halve_world_size" time="32.658" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_False_use_diff_optim_inputs_False" time="31.857" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_False_use_diff_optim_inputs_True" time="32.056" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_True_use_diff_optim_inputs_False" time="32.058" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_True_use_diff_optim_inputs_True" time="32.258" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_False_use_diff_optim_inputs_False" time="32.060" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_False_use_diff_optim_inputs_True" time="31.757" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_True_use_diff_optim_inputs_False" time="32.053" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_True_use_diff_optim_inputs_True" time="32.158" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_scatter_full_optim_state_dict_transformer" time="32.058"><failure message="RuntimeError: Process 2 exited with error code 10 and exception:&#10;Traceback (most recent call last):&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 864, in run_test&#10;    getattr(self, test_name)()&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 718, in wrapper&#10;    fn()&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py&quot;, line 3226, in wrapper&#10;    method(*args, **kwargs)&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 221, in wrapper&#10;    return func(*args, **kwargs)&#10;  File &quot;/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/fsdp/test_fsdp_optim_state.py&quot;, line 838, in test_scatter_full_optim_state_dict_transformer&#10;    self.run_subtests(&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_fsdp.py&quot;, line 1188, in run_subtests&#10;    return run_subtests(self, *args, **kwargs)&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 1147, in run_subtests&#10;    test_fn(*test_args, **test_kwargs, **subtest_kwargs)&#10;  File &quot;/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/fsdp/test_fsdp_optim_state.py&quot;, line 1131, in _test_load_optim_state&#10;    self._check_same_state(&#10;  File &quot;/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/fsdp/test_fsdp_optim_state.py&quot;, line 470, in _check_same_state&#10;    self.assertEqual(value, ref_value)&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py&quot;, line 4181, in assertEqual&#10;    raise error_metas.pop()[0].to_error(  # type: ignore[index]&#10;AssertionError: Tensor-likes are not close!&#10;&#10;Mismatched elements: 5 / 230 (2.2%)&#10;Greatest absolute difference: 4.1931867599487305e-05 at index (152,) (up to 1e-05 allowed)&#10;Greatest relative difference: 0.01582253910601139 at index (152,) (up to 1.3e-06 allowed)&#10;&#10;To execute this test, run the following from the base repo dir:&#10;    PYTORCH_TEST_WITH_SLOW=1 python test/distributed/fsdp/test_fsdp_optim_state.py TestFSDPOptimState.test_scatter_full_optim_state_dict_transformer&#10;&#10;This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0">Traceback (most recent call last):
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 59, in testPartExecutor
    yield
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 591, in run
    self._callTestMethod(testMethod)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 549, in _callTestMethod
    method()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 716, in wrapper
    self._join_processes(fn)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 980, in _join_processes
    self._check_return_codes(fn, elapsed_time)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 1020, in _check_return_codes
    raise RuntimeError(error)
RuntimeError: Process 2 exited with error code 10 and exception:
Traceback (most recent call last):
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 864, in run_test
    getattr(self, test_name)()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 718, in wrapper
    fn()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py", line 3226, in wrapper
    method(*args, **kwargs)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 221, in wrapper
    return func(*args, **kwargs)
  File "/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/fsdp/test_fsdp_optim_state.py", line 838, in test_scatter_full_optim_state_dict_transformer
    self.run_subtests(
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_fsdp.py", line 1188, in run_subtests
    return run_subtests(self, *args, **kwargs)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 1147, in run_subtests
    test_fn(*test_args, **test_kwargs, **subtest_kwargs)
  File "/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/fsdp/test_fsdp_optim_state.py", line 1131, in _test_load_optim_state
    self._check_same_state(
  File "/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/fsdp/test_fsdp_optim_state.py", line 470, in _check_same_state
    self.assertEqual(value, ref_value)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py", line 4181, in assertEqual
    raise error_metas.pop()[0].to_error(  # type: ignore[index]
AssertionError: Tensor-likes are not close!

Mismatched elements: 5 / 230 (2.2%)
Greatest absolute difference: 4.1931867599487305e-05 at index (152,) (up to 1e-05 allowed)
Greatest relative difference: 0.01582253910601139 at index (152,) (up to 1.3e-06 allowed)

To execute this test, run the following from the base repo dir:
    PYTORCH_TEST_WITH_SLOW=1 python test/distributed/fsdp/test_fsdp_optim_state.py TestFSDPOptimState.test_scatter_full_optim_state_dict_transformer

This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0</failure></testcase><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_halve_world_size" time="32.959" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_False_use_diff_optim_inputs_False" time="31.958" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_False_use_diff_optim_inputs_True" time="31.456" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_True_use_diff_optim_inputs_False" time="31.957" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_False_wrap_alt_True_use_diff_optim_inputs_True" time="31.958" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_False_use_diff_optim_inputs_False" time="32.058" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_False_use_diff_optim_inputs_True" time="31.958" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_True_use_diff_optim_inputs_False" time="31.457" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_nested_use_multiple_param_groups_True_wrap_alt_True_use_diff_optim_inputs_True" time="31.858" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_transformer" time="33.560" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_unmanaged_params_state_dict_type0_add_to_fsdp_module_False" time="31.557" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_unmanaged_params_state_dict_type0_add_to_fsdp_module_True" time="31.657" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_unmanaged_params_state_dict_type1_add_to_fsdp_module_False" time="31.357" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_shard_full_optim_state_dict_unmanaged_params_state_dict_type1_add_to_fsdp_module_True" time="31.658" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_state_dict_with_none_tensor_state" time="31.756" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_use_orig_params" time="34.261" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_with_empty_optimizer_state" time="15.731" /><testcase classname="test.distributed.fsdp.test_fsdp_optim_state.TestFSDPOptimState" name="test_with_no_shard" time="16.632" /></testsuite></testsuites>