<?xml version="1.0" encoding="utf-8"?><testsuites name="pytest tests"><testsuite name="pytest" errors="0" failures="2" skipped="0" tests="25" time="725.363" timestamp="2025-09-11T18:16:01.432760+00:00" hostname="dut7358"><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_activation_ckpt_fqns_ddp" time="15.810" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_activation_ckpt_fqns_fsdp1" time="15.831" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_broadcast_from_rank0" time="32.541" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_compiled_fsdp" time="28.550" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_cpu_offload_full_state_dict" time="16.229" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_ddp" time="18.434" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_deprecate_api" time="16.131" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_extra_state" time="3.209" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_flattened_osd" time="19.036" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_fsdp" time="44.678" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_fsdp2" time="21.940" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_fsdp_ddp" time="28.552" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_fsdp_root_not_initialized" time="16.030" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_multi_device_load_model_state_dict" time="16.031" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_multi_param_groups" time="16.529" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_non_persistent_buffers" time="3.209" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_optim_state_dict_param_matching" time="16.127" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_set_cpu_model_state_dict_broadcast_from_rank0" time="15.927" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_setting_meta_device_model" time="15.927" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_setting_meta_device_model_broadcasting_and_memory" time="300.041"><failure message="RuntimeError: Process 0 terminated or timed out after 300.03490376472473 seconds">Traceback (most recent call last):
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 59, in testPartExecutor
    yield
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 591, in run
    self._callTestMethod(testMethod)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 549, in _callTestMethod
    method()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 716, in wrapper
    self._join_processes(fn)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 980, in _join_processes
    self._check_return_codes(fn, elapsed_time)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 1025, in _check_return_codes
    raise RuntimeError(
RuntimeError: Process 0 terminated or timed out after 300.03490376472473 seconds</failure></testcase><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_shared_weight" time="22.639"><failure message="RuntimeError: Process 1 exited with error code 10 and exception:&#10;Traceback (most recent call last):&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 864, in run_test&#10;    getattr(self, test_name)()&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 718, in wrapper&#10;    fn()&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py&quot;, line 3226, in wrapper&#10;    method(*args, **kwargs)&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py&quot;, line 505, in wrapper&#10;    raise e&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py&quot;, line 502, in wrapper&#10;    func(self, *args, **kwargs)  # type: ignore[misc]&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 221, in wrapper&#10;    return func(*args, **kwargs)&#10;  File &quot;/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/checkpoint/test_state_dict.py&quot;, line 837, in test_shared_weight&#10;    self.run_subtests(&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py&quot;, line 482, in run_subtests&#10;    return run_subtests(self, *args, **kwargs)&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py&quot;, line 1147, in run_subtests&#10;    test_fn(*test_args, **test_kwargs, **subtest_kwargs)&#10;  File &quot;/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/checkpoint/test_state_dict.py&quot;, line 125, in _test_save_load&#10;    self._verify_osd_by_load(model, optim, copy_optim, dist_osd)&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/common_state_dict.py&quot;, line 122, in _verify_osd_by_load&#10;    self.assertEqual(optim.state_dict(), new_optim.state_dict())&#10;  File &quot;/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py&quot;, line 4181, in assertEqual&#10;    raise error_metas.pop()[0].to_error(  # type: ignore[index]&#10;AssertionError: Tensor-likes are not close!&#10;&#10;Mismatched elements: 1 / 3000000 (0.0%)&#10;Greatest absolute difference: 1.2874603271484375e-05 at index (2, 162) (up to 1e-05 allowed)&#10;Greatest relative difference: 6.078811111365212e-06 at index (2, 162) (up to 1.3e-06 allowed)&#10;&#10;The failure occurred for item ['state'][0]['exp_avg']&#10;&#10;To execute this test, run the following from the base repo dir:&#10;    PYTORCH_TEST_WITH_SLOW=1 python test/distributed/checkpoint/test_state_dict.py TestStateDict.test_shared_weight&#10;&#10;This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0">Traceback (most recent call last):
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 59, in testPartExecutor
    yield
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 591, in run
    self._callTestMethod(testMethod)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/unittest/case.py", line 549, in _callTestMethod
    method()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 716, in wrapper
    self._join_processes(fn)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 980, in _join_processes
    self._check_return_codes(fn, elapsed_time)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 1020, in _check_return_codes
    raise RuntimeError(error)
RuntimeError: Process 1 exited with error code 10 and exception:
Traceback (most recent call last):
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 864, in run_test
    getattr(self, test_name)()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 718, in wrapper
    fn()
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py", line 3226, in wrapper
    method(*args, **kwargs)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 505, in wrapper
    raise e
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 502, in wrapper
    func(self, *args, **kwargs)  # type: ignore[misc]
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 221, in wrapper
    return func(*args, **kwargs)
  File "/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/checkpoint/test_state_dict.py", line 837, in test_shared_weight
    self.run_subtests(
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/_tensor/common_dtensor.py", line 482, in run_subtests
    return run_subtests(self, *args, **kwargs)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_distributed.py", line 1147, in run_subtests
    test_fn(*test_args, **test_kwargs, **subtest_kwargs)
  File "/home/jenkins/actions-runner/_work/torch-xpu-ops/torch-xpu-ops/pytorch/test/distributed/checkpoint/test_state_dict.py", line 125, in _test_save_load
    self._verify_osd_by_load(model, optim, copy_optim, dist_osd)
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/distributed/common_state_dict.py", line 122, in _verify_osd_by_load
    self.assertEqual(optim.state_dict(), new_optim.state_dict())
  File "/tmp/xpu-tool/Python/3.10.18/x64/lib/python3.10/site-packages/torch/testing/_internal/common_utils.py", line 4181, in assertEqual
    raise error_metas.pop()[0].to_error(  # type: ignore[index]
AssertionError: Tensor-likes are not close!

Mismatched elements: 1 / 3000000 (0.0%)
Greatest absolute difference: 1.2874603271484375e-05 at index (2, 162) (up to 1e-05 allowed)
Greatest relative difference: 6.078811111365212e-06 at index (2, 162) (up to 1.3e-06 allowed)

The failure occurred for item ['state'][0]['exp_avg']

To execute this test, run the following from the base repo dir:
    PYTORCH_TEST_WITH_SLOW=1 python test/distributed/checkpoint/test_state_dict.py TestStateDict.test_shared_weight

This message can be suppressed by setting PYTORCH_PRINT_REPRO_ON_FAILURE=0</failure></testcase><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_single_gpu" time="5.012" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_state_dict_with_hook_on_keys" time="15.727" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestStateDict" name="test_strict" time="15.922" /><testcase classname="test.distributed.checkpoint.test_state_dict.TestNoComm" name="test_no_dist" time="3.109" /></testsuite></testsuites>